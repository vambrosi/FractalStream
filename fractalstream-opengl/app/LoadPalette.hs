module LoadPalette ( initTexture ) where

import Foreign.Marshal.Array

import Graphics.Rendering.OpenGL

-- | Creates a 1D texture with the twilight palette
initTexture :: IO ()
initTexture = do
  twilightName <- genObjectName
  textureBinding Texture1D $= Just twilightName
  textureWrapMode Texture1D S $= (Repeated, Repeat)
  textureFilter Texture1D $= ((Linear', Nothing), Linear')
  withImage $ texImage1D Texture1D NoProxy 0  RGB' imageSize 0
  texture Texture3D $= Enabled

imageSize :: TextureSize1D
imageSize = TextureSize1D 512

withImage :: (PixelData (Color3 GLubyte) -> IO ()) -> IO ()
withImage act = withArray twilight $ act . PixelData RGB UnsignedByte

twilight :: [Color3 GLubyte]
twilight = [
    (Color3 243 234 244), (Color3 242 233 243), (Color3 240 232 241),  (Color3 239 231 240)
  , (Color3 237 230 239), (Color3 235 230 238), (Color3 234 229 236),  (Color3 232 228 235)
  , (Color3 231 227 234), (Color3 229 226 233), (Color3 228 225 232),  (Color3 227 224 231)
  , (Color3 225 223 230), (Color3 224 222 229), (Color3 222 222 228),  (Color3 221 221 227)
  , (Color3 219 220 226), (Color3 218 219 225), (Color3 216 218 224),  (Color3 215 217 223)
  , (Color3 213 216 222), (Color3 212 215 221), (Color3 210 215 220),  (Color3 209 214 219)
  , (Color3 207 213 218), (Color3 206 212 217), (Color3 204 211 217),  (Color3 202 210 216)
  , (Color3 201 209 215), (Color3 199 209 214), (Color3 198 208 214),  (Color3 196 207 213)
  , (Color3 195 206 212), (Color3 193 205 211), (Color3 191 205 211),  (Color3 190 204 210)
  , (Color3 188 203 209), (Color3 187 202 209), (Color3 185 201 208),  (Color3 184 200 208)
  , (Color3 182 200 207), (Color3 180 199 206), (Color3 179 198 206),  (Color3 177 197 205)
  , (Color3 176 196 205), (Color3 174 196 204), (Color3 173 195 204),  (Color3 171 194 203)
  , (Color3 170 193 203), (Color3 168 192 203), (Color3 167 191 202),  (Color3 165 191 202)
  , (Color3 164 190 201), (Color3 162 189 201), (Color3 161 188 201),  (Color3 159 187 200)
  , (Color3 158 186 200), (Color3 156 186 200), (Color3 155 185 199),  (Color3 153 184 199)
  , (Color3 152 183 199), (Color3 151 182 199), (Color3 149 181 198),  (Color3 148 180 198)
  , (Color3 147 179 198), (Color3 145 179 198), (Color3 144 178 197),  (Color3 143 177 197)
  , (Color3 142 176 197), (Color3 140 175 197), (Color3 139 174 196),  (Color3 138 173 196)
  , (Color3 137 172 196), (Color3 135 171 196), (Color3 134 170 196),  (Color3 133 170 195)
  , (Color3 132 169 195), (Color3 131 168 195), (Color3 130 167 195),  (Color3 129 166 195)
  , (Color3 128 165 195), (Color3 127 164 194), (Color3 126 163 194),  (Color3 125 162 194)
  , (Color3 124 161 194), (Color3 123 160 194), (Color3 122 159 194),  (Color3 121 158 193)
  , (Color3 120 157 193), (Color3 119 156 193), (Color3 118 155 193),  (Color3 117 154 193)
  , (Color3 116 153 193), (Color3 115 153 192), (Color3 115 152 192),  (Color3 114 151 192)
  , (Color3 113 150 192), (Color3 112 149 192), (Color3 111 148 192),  (Color3 111 147 192)
  , (Color3 110 146 191), (Color3 109 145 191), (Color3 109 144 191),  (Color3 108 143 191)
  , (Color3 107 142 191), (Color3 107 141 191), (Color3 106 140 190),  (Color3 106 138 190)
  , (Color3 105 137 190), (Color3 104 136 190), (Color3 104 135 190),  (Color3 103 134 190)
  , (Color3 103 133 189), (Color3 102 132 189), (Color3 102 131 189),  (Color3 102 130 189)
  , (Color3 101 129 189), (Color3 101 128 188), (Color3 100 127 188),  (Color3 100 126 188)
  , (Color3 100 125 188), (Color3  99 124 188), (Color3  99 123 187),   (Color3 99 122 187)
  , (Color3  98 121 187), (Color3  98 119 187), (Color3  98 118 186),   (Color3 98 117 186)
  , (Color3  97 116 186), (Color3  97 115 185), (Color3  97 114 185),   (Color3 97 113 185)
  , (Color3  96 112 185), (Color3  96 111 184), (Color3  96 109 184),   (Color3 96 108 184)
  , (Color3  96 107 183), (Color3  96 106 183), (Color3  96 105 183),   (Color3 95 104 182)
  , (Color3  95 103 182), (Color3  95 102 181), (Color3  95 100 181),   (Color3 95  99 181)
  , (Color3  95  98 180), (Color3  95  97 180), (Color3  95  96 179),   (Color3 95  95 179)
  , (Color3  95  93 178), (Color3  95  92 178), (Color3  95  91 177),   (Color3 94  90 177)
  , (Color3  94  89 176), (Color3  94  88 176), (Color3  94  86 175),   (Color3 94  85 175)
  , (Color3  94  84 174), (Color3  94  83 174), (Color3  94  82 173),   (Color3 94  80 172)
  , (Color3  94  79 172), (Color3  94  78 171), (Color3  94  77 170),   (Color3 94  76 170)
  , (Color3  94  74 169), (Color3  94  73 168), (Color3  94  72 168),   (Color3 94  71 167)
  , (Color3  93  69 166), (Color3  93  68 165), (Color3  93  67 165),   (Color3 93  66 164)
  , (Color3  93  65 163), (Color3  93  63 162), (Color3  93  62 161),   (Color3 93  61 160)
  , (Color3  93  60 159), (Color3  92  58 158), (Color3  92  57 157),   (Color3 92  56 157)
  , (Color3  92  55 156), (Color3  92  54 154), (Color3  91  52 153),   (Color3 91  51 152)
  , (Color3  91  50 151), (Color3  91  49 150), (Color3  91  48 149),   (Color3 90  47 148)
  , (Color3  90  45 147), (Color3  90  44 145), (Color3  89  43 144),   (Color3 89  42 143)
  , (Color3  89  41 142), (Color3  88  40 140), (Color3  88  39 139),   (Color3 88  38 137)
  , (Color3  87  37 136), (Color3  87  36 135), (Color3  86  35 133),   (Color3 86  34 132)
  , (Color3  85  33 130), (Color3  85  32 128), (Color3  84  31 127),   (Color3 84  30 125)
  , (Color3  83  29 124), (Color3  82  28 122), (Color3  82  28 120),   (Color3 81  27 119)
  , (Color3  80  26 117), (Color3  80  25 115), (Color3  79  25 114),   (Color3 78  24 112)
  , (Color3  77  23 110), (Color3  77  23 108), (Color3  76  22 107),   (Color3 75  22 105)
  , (Color3  74  21 103), (Color3  73  21 101), (Color3  72  20  99),   (Color3 71  20  98)
  , (Color3  70  19  96), (Color3  70  19  94), (Color3  69  18  92),   (Color3 68  18  91)
  , (Color3  67  18  89), (Color3  66  17  87), (Color3  65  17  86),   (Color3 64  16  84)
  , (Color3  63  16  82), (Color3  62  16  80), (Color3  61  15  79),   (Color3 60  15  77)
  , (Color3  59  15  75), (Color3  58  14  74), (Color3  56  14  72),   (Color3 55  13  71)
  , (Color3  54  13  69), (Color3  53  13  67), (Color3  52  12  66),   (Color3 51  12  64)
  , (Color3  50  11  63), (Color3  49  11  61), (Color3  48  11  60),   (Color3 47  10  58)
  , (Color3  46  10  56), (Color3  45   9  55), (Color3  43   9  53),   (Color3 42   8  52)
  , (Color3  41   8  50), (Color3  40   8  49), (Color3  39   7  47),   (Color3 38   7  46)
  , (Color3  37   6  44), (Color3  36   6  43), (Color3  34   6  42),   (Color3 33   5  40)
  , (Color3  33   5  40), (Color3  34   6  41), (Color3  36   6  42),   (Color3 37   6  43)
  , (Color3  38   7  44), (Color3  40   7  45), (Color3  41   8  45),   (Color3 42   8  46)
  , (Color3  43   9  47), (Color3  45   9  48), (Color3  46  10  49),   (Color3 47  10  50)
  , (Color3  49  11  51), (Color3  50  11  51), (Color3  51  12  52),   (Color3 52  12  53)
  , (Color3  54  12  54), (Color3  55  13  55), (Color3  56  13  55),   (Color3 58  14  56)
  , (Color3  59  14  57), (Color3  60  14  58), (Color3  61  15  58),   (Color3 63  15  59)
  , (Color3  64  16  60), (Color3  65  16  61), (Color3  67  16  61),   (Color3 68  17  62)
  , (Color3  69  17  63), (Color3  71  17  63), (Color3  72  18  64),   (Color3 73  18  65)
  , (Color3  75  18  65), (Color3  76  19  66), (Color3  77  19  67),   (Color3 79  19  67)
  , (Color3  80  20  68), (Color3  81  20  68), (Color3  82  20  69),   (Color3 84  21  70)
  , (Color3  85  21  70), (Color3  86  21  71), (Color3  88  22  71),   (Color3 89  22  72)
  , (Color3  90  22  72), (Color3  92  23  73), (Color3  93  23  73),   (Color3 94  23  74)
  , (Color3  96  23  74), (Color3  97  24  74), (Color3  98  24  75),  (Color3 100  25  75)
  , (Color3 101  25  76), (Color3 102  25  76), (Color3 104  26  76),  (Color3 105  26  77)
  , (Color3 106  26  77), (Color3 108  27  77), (Color3 109  27  77),  (Color3 110  28  78)
  , (Color3 112  28  78), (Color3 113  28  78), (Color3 114  29  78),  (Color3 115  29  79)
  , (Color3 117  30  79), (Color3 118  30  79), (Color3 119  31  79),  (Color3 120  31  79)
  , (Color3 122  32  79), (Color3 123  32  79), (Color3 124  33  79),  (Color3 125  33  80)
  , (Color3 127  34  80), (Color3 128  35  80), (Color3 129  35  80),  (Color3 130  36  80)
  , (Color3 131  37  80), (Color3 132  37  80), (Color3 134  38  80),  (Color3 135  39  80)
  , (Color3 136  39  80), (Color3 137  40  80), (Color3 138  41  80),  (Color3 139  42  80)
  , (Color3 140  43  80), (Color3 141  43  80), (Color3 142  44  79),  (Color3 143  45  79)
  , (Color3 144  46  79), (Color3 145  47  79), (Color3 146  48  79),  (Color3 148  49  79)
  , (Color3 149  49  79), (Color3 149  50  79), (Color3 150  51  79),  (Color3 151  52  79)
  , (Color3 152  53  79), (Color3 153  54  79), (Color3 154  55  79),  (Color3 155  56  79)
  , (Color3 156  57  79), (Color3 157  58  79), (Color3 158  59  79),  (Color3 159  60  79)
  , (Color3 160  61  79), (Color3 161  62  79), (Color3 161  63  79),  (Color3 162  64  79)
  , (Color3 163  65  79), (Color3 164  66  79), (Color3 165  67  79),  (Color3 166  68  79)
  , (Color3 166  69  79), (Color3 167  70  79), (Color3 168  71  79),  (Color3 169  72  79)
  , (Color3 169  73  80), (Color3 170  74  80), (Color3 171  76  80),  (Color3 172  77  80)
  , (Color3 172  78  80), (Color3 173  79  80), (Color3 174  80  80),  (Color3 175  81  81)
  , (Color3 175  82  81), (Color3 176  83  81), (Color3 177  84  81),  (Color3 177  86  81)
  , (Color3 178  87  82), (Color3 179  88  82), (Color3 179  89  82),  (Color3 180  90  82)
  , (Color3 180  91  83), (Color3 181  92  83), (Color3 182  94  83),  (Color3 182  95  84)
  , (Color3 183  96  84), (Color3 183  97  85), (Color3 184  98  85),  (Color3 184  99  85)
  , (Color3 185 101  86), (Color3 186 102  86), (Color3 186 103  87),  (Color3 187 104  87)
  , (Color3 187 105  88), (Color3 188 106  88), (Color3 188 108  89),  (Color3 189 109  89)
  , (Color3 189 110  90), (Color3 190 111  91), (Color3 190 113  91),  (Color3 190 114  92)
  , (Color3 191 115  93), (Color3 191 116  93), (Color3 192 117  94),  (Color3 192 119  95)
  , (Color3 193 120  95), (Color3 193 121  96), (Color3 193 122  97),  (Color3 194 123  98)
  , (Color3 194 125  99), (Color3 194 126 100), (Color3 195 127 101),  (Color3 195 128 101)
  , (Color3 195 130 102), (Color3 196 131 103), (Color3 196 132 104),  (Color3 196 133 105)
  , (Color3 197 135 106), (Color3 197 136 107), (Color3 197 137 109),  (Color3 198 138 110)
  , (Color3 198 140 111), (Color3 198 141 112), (Color3 199 142 113),  (Color3 199 143 114)
  , (Color3 199 144 116), (Color3 199 146 117), (Color3 200 147 118),  (Color3 200 148 119)
  , (Color3 200 149 121), (Color3 201 151 122), (Color3 201 152 123),  (Color3 201 153 125)
  , (Color3 201 154 126), (Color3 202 156 127), (Color3 202 157 129),  (Color3 202 158 130)
  , (Color3 203 159 132), (Color3 203 160 133), (Color3 203 162 135),  (Color3 203 163 136)
  , (Color3 204 164 138), (Color3 204 165 139), (Color3 204 166 141),  (Color3 205 168 143)
  , (Color3 205 169 144), (Color3 205 170 146), (Color3 206 171 147),  (Color3 206 172 149)
  , (Color3 206 173 151), (Color3 207 175 152), (Color3 207 176 154),  (Color3 207 177 156)
  , (Color3 208 178 157), (Color3 208 179 159), (Color3 209 180 161),  (Color3 209 182 163)
  , (Color3 209 183 164), (Color3 210 184 166), (Color3 210 185 168),  (Color3 211 186 170)
  , (Color3 211 187 171), (Color3 212 188 173), (Color3 212 189 175),  (Color3 213 191 177)
  , (Color3 213 192 178), (Color3 214 193 180), (Color3 214 194 182),  (Color3 215 195 184)
  , (Color3 215 196 186), (Color3 216 197 187), (Color3 216 198 189),  (Color3 217 199 191)
  , (Color3 218 200 193), (Color3 218 202 194), (Color3 219 203 196),  (Color3 219 204 198)
  , (Color3 220 205 200), (Color3 221 206 202), (Color3 221 207 203),  (Color3 222 208 205)
  , (Color3 223 209 207), (Color3 223 210 209), (Color3 224 211 210),  (Color3 225 213 212)
  , (Color3 226 214 214), (Color3 226 215 215), (Color3 227 216 217),  (Color3 228 217 219)
  , (Color3 229 218 220), (Color3 229 219 222), (Color3 230 220 223),  (Color3 231 221 225)
  , (Color3 232 222 226), (Color3 233 223 228), (Color3 234 225 229),  (Color3 235 226 231)
  , (Color3 236 227 233), (Color3 237 228 234), (Color3 238 229 236),  (Color3 239 230 237)
  , (Color3 240 231 239), (Color3 241 232 241), (Color3 242 233 242),  (Color3 243 234 244)
  ]