viewer:
  title: Mandelbrot set throwback
  style: complex-plane
  size: 512x512
  resizable: true
  z-coord: z
  iteration-limit: max_iters
  escape-radius: R
  initial-center: -0.75
  initial-pixel-size: 1/128
  code: |
      x : ℝ <- 2 mod(re z + size / 2, size) / size - 1
      y : ℝ <- 2 mod(im z + size / 2, size) / size - 1

      C : ℂ ⭠ z - (x + i y) * size / 2
      z <- 0

      iterate z ⟼ z² + C until z escapes

      color ⭠ rgb(0.980, 0.976, 0.965)
      if stuck and x^2 + y^2 < (1.5 - cos (6 arg(x + i y))) / 3:
          color ⭠ black

  tools:
    - name: Clicky
      actions:
        - event: click
          code: |
            clickedX <- 2 mod(re z + size / 2, size) / size - 1
            clickedY <- 2 mod(im z + size / 2, size) / size - 1
            clickedC ⭠ z - (clickedX + i clickedY) * size / 2
            norm2 <- clickedX^2 + clickedY^2
            bound <- (1.5 - cos (6 arg(clickedX + i clickedY))) / 3
            cond <- clickedX^2 + clickedY^2 < (1.5 - cos (6 arg(clickedX + i clickedY))) / 3
        - event: drag
          code: pass

configuration:
  title: Configuration
  size: 400x200
  vertical-contents:
    - text-entry:
        label: "Iteration limit"
        value: "250"
        type: ℤ
        variable: max_iters
    - text-entry:
        label: "Escape radius"
        value: "10"
        type: ℝ
        variable: R
    - text-entry:
        label: "Cell size"
        value: "0.035"
        type: ℝ
        variable: size
    - text-entry:
        label: "Clicked X"
        value: "0"
        type: R
        variable: clickedX
    - text-entry:
        label: "Clicked Y"
        value: "0"
        type: R
        variable: clickedY
    - text-entry:
        label: "Clicked C"
        value: "0"
        type: C
        variable: clickedC
    - text-entry:
        label: "Norm^2"
        value: "0"
        type: R
        variable: norm2
    - text-entry:
        label: "Bound"
        value: "0"
        type: R
        variable: bound
    - checkbox:
        label: "Condition"
        value: true
        variable: cond
