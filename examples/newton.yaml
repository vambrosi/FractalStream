viewer:
  style: complex-plane
  title: Roots of {f}
  size: 512x512
  resizable: true
  z-coord: z
  initial-center: 0
  initial-pixel-size: 1/128
  code: |
        k : Z <- 0
        lastZ : C <- 0

        while k < maxIters and |z - lastZ| > tol
          lastZ <- z
          z <- z - f / df
          k <- k + 1

        if k = maxIters then
          output black to color
        else
          c : Color <- if re(z) > 0 then red else if im(z) > 0 then yellow else blue
          s : R <- (cos (k pi / 10))^2
          output blend (s, dark c, light c) to color

  tools:
    - name: Trace
      shortcut: t
      actions:
        - event: deactivated
          code: erase
        - event: click-or-drag
          code: |
            k : Z <- 0
            lastZ : C <- 0
            erase
            while k < maxIters and |z - lastZ| > tol
              lastZ <- z
              z <- z - f / df
              draw point at lastZ
              draw line from lastZ to z
              k <- k + 1
            draw point at z

setup:
  title: Newton's method setup
  size: 200x200
  vertical-contents:
    - text-entry:
        label: "f(z) = "
        value: "z^3 - 1"
        type: C
        environment:
          z: C
        variable: f
    - text-entry:
        label: "f'(z) = "
        value: "3 z^2"
        type: C
        environment:
          z: C
        variable: df

configuration:
  title: Newton's method configuration
  size: 400x200
  vertical-contents:
    - text-entry:
        label: "closeness"
        value: "0.01"
        type: R
        variable: tol
    - text-entry:
        label: "Max. iterations: "
        value: "100"
        type: Z
        variable: maxIters
