viewers:
  - title: Parameter plane
    style: complex-plane
    size: 512x512
    resizable: true
    z-coord: a
    iteration-limit: maxIters
    vanishing-radius: tol
    initial-center: 0
    initial-pixel-size: 1/128
    code: |
        r1 : C <- 1
        r2 : C <- -0.5 + a
        r3 : C <- -0.5 - a
        z : C <- 0
        lastZ : C <- 0

        repeat:
          lastZ <- z
          f : C <- (z - r1) (z - r2) (z - r3)
          df : C <- (z - r2) (z - r3) + (z - r1) (z - r3) + (z - r1) (z - r2)
          z <- z - f / df
        while z != lastZ

        c : Color <- grey
        if z = r1:
          c <- red
        else if z = r2:
          c <- green
        else if z = r3:
          c <- blue

        s : R <- (cos (iterations pi / 10))^2
        color <- if z = lastZ then blend (s, dark c, light c) else black

  - title: Newton's method dynamics
    style: complex-plane
    size: 512x512
    resizable: true
    z-coord: z
    iteration-limit: maxIters
    vanishing-radius: tol
    initial-center: 0
    initial-pixel-size: 1/128
    code: |
        lastZ : C <- 0
        r1 : C <- 1
        r2 : C <- -0.5 + a
        r3 : C <- -0.5 - a

        repeat:
          lastZ <- z
          f : C <- (z - r1) (z - r2) (z - r3)
          df : C <- (z - r2) (z - r3) + (z - r1) (z - r3) + (z - r1) (z - r2)
          z <- z - f / df
        while z != lastZ

        c : Color <- grey
        if z = r1:
          c <- red
        else if z = r2:
          c <- green
        else if z = r3:
          c <- blue

        s : R <- (cos (iterations pi / 10))^2
        color <- if z = lastZ then blend (s, dark c, light c) else black

    tools:
      - name: Trace
        shortcut: t
        actions:
          - event: deactivated
            code: erase
          - event: click-or-drag
            code: |
              lastZ : C <- 0
              r1 : C <- 1
              r2 : C <- -0.5 + a
              r3 : C <- -0.5 - a
              erase
              while z != lastZ:
                lastZ <- z
                f : C <- (z - r1) (z - r2) (z - r3)
                df : C <- (z - r2) (z - r3) + (z - r1) (z - r3) + (z - r1) (z - r2)
                z <- z - f / df
                draw point at lastZ
                draw line from lastZ to z
              draw point at z

configuration:
  title: Newton's method configuration
  size: 400x200
  vertical-contents:
    - text-entry:
        label: "a ="
        value: "0"
        type: C
        variable: a
    - text-entry:
        label: "closeness"
        value: "0.01"
        type: R
        variable: tol
    - text-entry:
        label: "Max. iterations: "
        value: "100"
        type: Z
        variable: maxIters
