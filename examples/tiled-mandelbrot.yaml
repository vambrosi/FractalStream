viewer:
  title: Mandelbrot set tiled by Julia sets
  style: complex-plane
  size: 512x512
  resizable: true
  z-coord: w
  iteration-limit: max_iters
  escape-radius: R
  initial-center: 0
  initial-pixel-size: 1/128
  code: |
      x : ℝ <- if re w >= 0 then mod(re w, size) else size - mod(-re w, size)
      y : ℝ <- if im w >= 0 then mod(im w, size) else size - mod(-im w, size)

      C : ℂ ⭠ w - (x + i y) + (1 + i) size / 2
      z : ℂ ⭠ (x + i y - (1 + i) size / 2) * scale / size

      iterate z ⟼ z² + C until z escapes

      if stuck:
        color ⭠ black
      else:
        m : ℝ ⭠ iterations + 1 - log (log (|z|²) / (2 log R)) / log 2
        color ⭠ blend (2 arctan (m / 20) / pi, dark blue, white)

configuration:
  title: Configuration
  size: 400x200
  vertical-contents:
    - text-entry:
        label: "Iteration limit"
        value: "100"
        type: ℤ
        variable: max_iters
    - text-entry:
        label: "Escape radius"
        value: "10"
        type: ℝ
        variable: R
    - text-entry:
        label: "Julia set size"
        value: "0.05"
        type: ℝ
        variable: size
    - text-entry:
        label: "Julia set zoom level"
        value: "2.5"
        type: ℝ
        variable: scale
