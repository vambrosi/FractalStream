setup:
  title: One-variable parametric complex dynamics
  size: 200x200
  vertical-contents:
    - text-entry:
        label: "Title:"
        value: "Quadratic dynamics"
        type: Text
        variable: title
    - text: |
        This template can be used to make a script that draws in the z-plane and
        in the C-plane, where C is a complex parameter.

        The script runs once per pixel in the view, and should use the `color`
        variable to indicate what color to use for that pixel.

        Use the `dynamic` variable to test if the script is running in the `z`-plane.
    - text-entry:
        label: "Initial value for z in the C plane:"
        value: "0"
        type: C
        variable: z0
    - text-entry:
        label: "Initial value for C:"
        value: "0"
        type: C
        variable: initialC
    - code:
        variable: script
        environment:
          z: C
          C: C
          color: Color
          dynamic: Boolean
          maxIters: Z
          maxRadius: R
          minRadius: R
          "[internal] iteration count": Z
          "[internal] stuck": Boolean
          "[internal] iterations": Z
          "[internal] escape radius": R
          "[internal] vanishing radius": R
        value: |
          iterate z ⟼ z² + C until z escapes

          if stuck:
            color ⭠ black
          else if im z > 0:
            color ⭠ light rainbow(iterations / 20)
          else:
            color ⭠ dark rainbow(iterations / 20)

viewers:

  - title: $title$ parameter plane
    style: complex-plane
    size: 600x600
    resizable: true
    z-coord: C
    iteration-limit: maxIters
    escape-radius: maxRadius
    vanishing-radius: minRadius
    initial-center: 0
    initial-pixel-size: 1/100
    code: |
      dynamic : Boolean <- false
      z : C <- $z0$
      $script$

  - title: $title$ dynamical plane
    style: complex-plane
    size: 600x600
    resizable: true
    z-coord: z
    iteration-limit: maxIters
    escape-radius: maxRadius
    vanishing-radius: minRadius
    initial-center: 0
    initial-pixel-size: 1/100
    code: |
      dynamic : Boolean <- true
      $script$

configuration:
  title: Configuration
  size: 400x200
  vertical-contents:
    - panel:
        title: "Parameter value"
        text-entry:
          label: "C ="
          value: $initialC$
          type: C
          variable: C
    - panel:
        title: "Settings"
        vertical-contents:
          - text-entry:
              label: "Iteration limit: "
              value: "100"
              type: Z
              variable: maxIters
          - text-entry:
              label: "Escape radius: "
              value: "10"
              type: R
              variable: maxRadius
          - text-entry:
              label: "Vanishing radius: "
              value: "0.0001"
              type: R
              variable: minRadius
